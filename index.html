<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' stroke-width='2' stroke='black' fill='none' stroke-linecap='round' stroke-linejoin='round'><path stroke='none' d='M0 0h24v24H0z' fill='none' /><path d='M6 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0' /><path d='M12 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0' /><path d='M6 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0' /><path d='M18 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0' /><path d='M3 12h7m4 0h7' /><path d='M3 6h1m4 0h13' /><path d='M3 18h1m4 0h8m4 0h1' /><path d='M6 3v1m0 4v8m0 4v1' /><path d='M12 3v7m0 4v7' /><path d='M18 3v13m0 4v1' /></svg>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生活觀察</title>

    <link rel="manifest" href="manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&display=swap" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chocolate+Classical+Sans&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <div class="grainy-effect sidebar">
            <div class="sidebar-header">
                <h2><svg xmlns="http://www.w3.org/2000/svg" class="sidebar-Dashboard" viewBox="0 0 24 24"
                        stroke-width="2" stroke="currentColor" fill="currentColor" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path d="M6 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                        <path d="M12 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                        <path d="M6 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                        <path d="M18 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                        <path d="M3 12h7m4 0h7" />
                        <path d="M3 6h1m4 0h13" />
                        <path d="M3 18h1m4 0h8m4 0h1" />
                        <path d="M6 3v1m0 4v8m0 4v1" />
                        <path d="M12 3v7m0 4v7" />
                        <path d="M18 3v13m0 4v1" />
                    </svg>生活觀察</h2>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" onclick="showSection('attendance-tracker')"><svg xmlns="http://www.w3.org/2000/svg"
                            class="sidebar-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M20.984 12.53a9 9 0 1 0 -7.552 8.355" />
                            <path d="M12 7v5l3 3" />
                            <path d="M19 16l-2 3h4l-2 3" />
                        </svg><span class="menu-item-text">打卡記錄</span></a></li>
                <li><a href="#" onclick="showSection('time-quadrant')"><svg xmlns="http://www.w3.org/2000/svg"
                            class="sidebar-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
                            <path d="M18 14v4h4" />
                            <path d="M18 18m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
                            <path d="M15 3v4" />
                            <path d="M7 3v4" />
                            <path d="M3 11h16" />
                        </svg><span class="menu-item-text">時間安排</span></a></li>
                <li><a href="#" onclick="showSection('habit-tracker')"><svg xmlns="http://www.w3.org/2000/svg"
                            class="sidebar-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
                            <path d="M12 7a5 5 0 1 0 5 5" />
                            <path d="M13 3.055a9 9 0 1 0 7.941 7.945" />
                            <path d="M15 6v3h3l3 -3h-3v-3z" />
                            <path d="M15 9l-3 3" />
                        </svg><span class="menu-item-text">習慣培養</span></a></li>
                <li><a href="#" class="active" onclick="showSection('mood-entry')"><svg
                            xmlns="http://www.w3.org/2000/svg" class="sidebar-icon" viewBox="0 0 24 24" stroke-width="2"
                            stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path
                                d="M6 4h11a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-11a1 1 0 0 1 -1 -1v-14a1 1 0 0 1 1 -1m3 0v18" />
                            <path d="M13 8l2 0" />
                            <path d="M13 12l2 0" />
                        </svg><span class="menu-item-text">心情筆記</span></a></li>
                <li><a href="#" onclick="showSection('review-stats')"><svg xmlns="http://www.w3.org/2000/svg"
                            class="sidebar-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path
                                d="M17 8v-3a1 1 0 0 0 -1 -1h-10a2 2 0 0 0 0 4h12a1 1 0 0 1 1 1v3m0 4v3a1 1 0 0 1 -1 1h-12a2 2 0 0 1 -2 -2v-12" />
                            <path d="M20 12v4h-4a2 2 0 0 1 0 -4h4" />
                        </svg><span class="menu-item-text">綜合統計</span></a></li>
                <li><a href="#" onclick="showSection('image-memory')"><svg xmlns="http://www.w3.org/2000/svg"
                            class="sidebar-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M15 8h.01" />
                            <path d="M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z" />
                            <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5" />
                            <path d="M14 14l1 -1c.928 -.893 2.072 -.893 3 0l2 2" />
                        </svg><span class="menu-item-text">圖像記憶</span></a></li>
                <li><a href="#" onclick="showSection('data-settings')"><svg xmlns="http://www.w3.org/2000/svg"
                            class="sidebar-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path
                                d="M14.647 4.081a.724 .724 0 0 0 1.08 .448c2.439 -1.485 5.23 1.305 3.745 3.744a.724 .724 0 0 0 .447 1.08c2.775 .673 2.775 4.62 0 5.294a.724 .724 0 0 0 -.448 1.08c1.485 2.439 -1.305 5.23 -3.744 3.745a.724 .724 0 0 0 -1.08 .447c-.673 2.775 -4.62 2.775 -5.294 0a.724 .724 0 0 0 -1.08 -.448c-2.439 1.485 -5.23 -1.305 -3.745 -3.744a.724 .724 0 0 0 -.447 -1.08c-2.775 -.673 -2.775 -4.62 0 -5.294a.724 .724 0 0 0 .448 -1.08c-1.485 -2.439 1.305 -5.23 3.744 -3.745a.722 .722 0 0 0 1.08 -.447c.673 -2.775 4.62 -2.775 5.294 0zm-2.647 4.919a3 3 0 1 0 0 6a3 3 0 0 0 0 -6z"
                                stroke-width="0" fill="currentColor" />
                        </svg><span class="menu-item-text">資料管理</span></a></li>
            </ul>
        </div>

        <div class="main-content">
            <div class="header">
                <h1 id="app-title">✍️ 今日心情記錄</h1>
                <div class="date" id="current-date"></div>
            </div>

            <!-- ======================= 內容區域 ======================= -->

            <!-- 1. 打卡記錄 -->
            <div id="attendance-tracker-section" class="content-section hidden">
                <div class="punch-section">
                    <div class="punch-buttons">
                        <button class="punch-btn work-in" id="workInBtn"
                            onclick="AttendanceTracker.punchCard('work-in')"><svg xmlns="http://www.w3.org/2000/svg"
                                class="content-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path d="M6.5 7h11" />
                                <path d="M6.5 17h11" />
                                <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z" />
                                <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z" />
                            </svg>上工打卡</button>
                        <button class="punch-btn work-out" id="workOutBtn"
                            onclick="AttendanceTracker.punchCard('work-out')"><svg xmlns="http://www.w3.org/2000/svg"
                                class="content-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path d="M18 18v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1v-2a6 6 0 0 1 6 -6" />
                                <path d="M6 6a6 6 0 0 0 6 6m3.13 -.88a6 6 0 0 0 2.87 -5.12v-2a1 1 0 0 0 -1 -1h-10" />
                                <path d="M3 3l18 18" />
                            </svg>下工打卡</button>
                        <button class="punch-btn break-start" id="breakStartBtn"
                            onclick="AttendanceTracker.punchCard('break-start')"><svg xmlns="http://www.w3.org/2000/svg"
                                class="content-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path
                                    d="M4 11h16a1 1 0 0 1 1 1v.5c0 1.5 -2.517 5.573 -4 6.5v1a1 1 0 0 1 -1 1h-8a1 1 0 0 1 -1 -1v-1c-1.687 -1.054 -4 -5 -4 -6.5v-.5a1 1 0 0 1 1 -1z" />
                                <path d="M12 4a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2" />
                                <path d="M16 4a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2" />
                                <path d="M8 4a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2" />
                            </svg>中場休息</button>
                        <button class="punch-btn break-end" id="breakEndBtn"
                            onclick="AttendanceTracker.punchCard('break-end')"><svg xmlns="http://www.w3.org/2000/svg"
                                class="content-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path d="M3 19h16" />
                                <path
                                    d="M15 11h6c0 1.691 -.525 3.26 -1.42 4.552m-2.034 2.032a7.963 7.963 0 0 1 -4.546 1.416h-2a8 8 0 0 1 -8 -8h8" />
                                <path d="M12 5v3" />
                                <path d="M15 5v3" />
                                <path d="M3 3l18 18" />
                            </svg>結束休息</button>
                    </div>
                </div>
                <div class="tracker-main-grid">
                    <div class="tracker-grid-left">
                        <div class="card-1 grainy-effect card particles">
                            <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" stroke-width="2"
                                    stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path
                                        d="M13.256 20.473c-.855 .907 -2.583 .643 -2.931 -.79a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.07 .26 1.488 1.29 1.254 2.15" />
                                    <path d="M19 16l-2 3h4l-2 3" />
                                    <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                                </svg>提醒設定</h3>
                            <div id="notificationPermission" class="notification-permission"></div>
                            <div class="setting-row">
                                <label for="workHours">工作時數:</label>
                                <input type="number" class="input-field-Details input-short" id="workHours" value="8"
                                    min="1" max="24" onchange="AttendanceTracker.saveSettings()">
                                <span>小時</span>
                            </div>
                            <div class="setting-row">
                                <label for="breakMinutes">休息時間:</label>
                                <input type="number" class="input-field-Details input-short" id="breakMinutes"
                                    value="15" min="1" max="120" onchange="AttendanceTracker.saveSettings()">
                                <span>分鐘</span>
                            </div>
                            <div class="setting-row">
                                <label>
                                    <input type="checkbox" id="enableSound" checked
                                        onchange="AttendanceTracker.saveSettings()">
                                    啟用提醒音效
                                </label>
                            </div>
                        </div>
                        <div class="charts-section">
                            <div class="card-1 grainy-effect chart-container card particles">
                                <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M7 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
                                        <path d="M7 3v4h4" />
                                        <path d="M9 17l0 4" />
                                        <path d="M17 14l0 7" />
                                        <path d="M13 13l0 8" />
                                        <path d="M21 12l0 9" />
                                    </svg>本週工作時數</h3>
                                <canvas id="weekChart" width="400" height="200"></canvas>
                            </div>
                            <div class="card-1 grainy-effect chart-container card particles">
                                <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M3 3v18h18" />
                                        <path d="M20 18v3" />
                                        <path d="M16 16v5" />
                                        <path d="M12 13v8" />
                                        <path d="M8 16v5" />
                                        <path d="M3 11c6 0 5 -5 9 -5s3 5 9 5" />
                                    </svg>本月工作時數</h3>
                                <canvas id="monthChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="tracker-grid-right">
                        <div class="card-2 grainy-effect card particles">
                            <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" stroke-width="2"
                                    stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M20.984 12.53a9 9 0 1 0 -7.552 8.355" />
                                    <path d="M12 7v5l3 3" />
                                    <path d="M19 16l-2 3h4l-2 3" />
                                </svg>當前狀態</h3>
                            <div id="statusContent">尚未打卡</div>
                        </div>
                        <div class="grainy-effect card particles card-2" style="display: flex; flex-direction: column;">
                            <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M9 6l11 0" />
                                    <path d="M9 12l11 0" />
                                    <path d="M9 18l11 0" />
                                    <path d="M5 6l0 .01" />
                                    <path d="M5 12l0 .01" />
                                    <path d="M5 18l0 .01" />
                                </svg>最近記錄</h3>
                            <div id="recordsList"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2. 時間安排 -->
            <div id="time-quadrant-section" class="content-section hidden">
                <div class="time-schedule-grid">
                    <div class="card-1 particles grainy-effect timeline-panel card">
                        <div class="timeline-header">
                            <button id="prev-day-btn" class="date-nav">‹</button>
                            <label style="cursor: pointer;">
                                <h2 id="current-date-display" style="margin: 0;">2025年 8月 8日 (五)</h2>
                            </label>
                            <button id="next-day-btn" class="date-nav">›</button>
                        </div>
                        <div class="timeline-body" id="timeline-container">
                        </div>
                    </div>
                    <div class="tools-panel" style="display: flex; flex-direction: column; gap: 20px;">
                        <div class="card-2 particles quadrant-info-card card tools-panel-card-style grainy-effect">
                            <h3 style="margin-top:0;"><svg xmlns="http://www.w3.org/2000/svg" class="content-icon"
                                    viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                    stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M4 4h6v8h-6z" />
                                    <path d="M4 16h6v4h-6z" />
                                    <path d="M14 12h6v8h-6z" />
                                    <path d="M14 4h6v4h-6z" />
                                </svg>時間四象限 - 自我提醒</h3>
                            <div class="matrix-grid" id="eisenhower-matrix-container">
                            </div>
                        </div>
                        <div class="card-2 grainy-effect card particles">
                            <h3 style="margin-top:0;"><svg xmlns="http://www.w3.org/2000/svg" class="content-icon"
                                    viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                    stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M7 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
                                    <path d="M7 3v4h4" />
                                    <path d="M9 17l0 4" />
                                    <path d="M17 14l0 7" />
                                    <path d="M13 13l0 8" />
                                    <path d="M21 12l0 9" />
                                </svg>本日完成統計</h3>
                            <div class="chart-container"
                                style="display: flex; justify-content: center; align-items: center; min-height: 200px; position: relative;">
                                <div id="daily-pie-chart-container" class="pie-chart-container"></div>
                            </div>
                        </div>
                        <div class="card-2 grainy-effect card particles">
                            <h3 style="margin-top:0;"><svg xmlns="http://www.w3.org/2000/svg" class="content-icon"
                                    viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                    stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M3 3v18h18" />
                                    <path d="M20 18v3" />
                                    <path d="M16 16v5" />
                                    <path d="M12 13v8" />
                                    <path d="M8 16v5" />
                                    <path d="M3 11c6 0 5 -5 9 -5s3 5 9 5" />
                                </svg>本月完成統計</h3>
                            <div class="chart-container"
                                style="display: flex; justify-content: center; align-items: center; min-height: 200px; position: relative;">
                                <div id="monthly-pie-chart-container" class="pie-chart-container"></div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!-- 3. 習慣培養 -->
            <div id="habit-tracker-section" class="content-section hidden">
                <div class="content-grid">
                    <div class="main-column">
                        <div class="card-1 grainy-effect card particles">
                            <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M20.925 13.163a8.998 8.998 0 0 0 -8.925 -10.163a9 9 0 0 0 0 18" />
                                    <path d="M9 10h.01" />
                                    <path d="M15 10h.01" />
                                    <path d="M9.5 15c.658 .64 1.56 1 2.5 1s1.842 -.36 2.5 -1" />
                                    <path d="M15 19l2 2l4 -4" />
                                </svg>我的習慣</h3>
                            <div id="habit-list-container"></div>
                        </div>
                    </div>
                    <div class="side-column">
                        <div class="card-2 grainy-effect card particles">
                            <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M3 3v18h18" />
                                    <path d="M16 16v5" />
                                    <path d="M12 13v8" />
                                    <path d="M8 16v5" />
                                    <path d="M3 11c6 0 5 -5 9 -5s3 5 9 5" />
                                </svg>完成率報告</h3>
                            <div class="form-group">
                                <label for="habit-report-period">選擇週期</label>
                                <select id="habit-report-period" class="input-field-Details"
                                    onchange="HabitTracker.renderReportChart()">
                                    <option value="weekly">本週報告</option>
                                    <option value="monthly">本月報告</option>
                                </select>
                            </div>
                            <canvas id="habit-report-chart"></canvas>
                        </div>
                        <div class="card-2 grainy-effect card particles">
                            <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M9.615 20h-2.615a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8" />
                                    <path d="M14 19l2 2l4 -4" />
                                    <path d="M9 8h4" />
                                    <path d="M9 12h2" />
                                </svg>新增習慣</h3>
                            <div class="form-group">
                                <label>想培養什麼新習慣呢？</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" class="input-field-Details" id="new-habit-input"
                                        placeholder="例如：每日喝足 2000cc 的水">
                                    <button class="btn" onclick="HabitTracker.addHabit()"><svg
                                            xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                            stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" />
                                            <path d="M16 19h6" />
                                            <path d="M19 16v6" />
                                            <path d="M6 21v-2a4 4 0 0 1 4 -4h4" />
                                        </svg></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 4. 心情筆記 -->
            <div id="mood-entry-section" class="content-section hidden">
                <div class="content-grid">
                    <div class="main-column">
                        <div class="card-1 grainy-effect card particles" id="pinned-notes-card">
                            <h3>
                                <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M9 4v6l-2 4v2h10v-2l-2 -4v-6" />
                                    <line x1="12" y1="16" x2="12" y2="21" />
                                    <line x1="8" y1="4" x2="16" y2="4" />
                                </svg>釘選筆記
                            </h3>
                            <div id="pinned-notes-content">
                                <p>沒有釘選的筆記。</p>
                            </div>
                        </div>
                        <div class="card-1 grainy-effect card particles">
                            <h3>
                                <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                                    <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                                    <path d="M9 9l3 0" />
                                    <path d="M9 13l6 0" />
                                    <path d="M9 17l6 0" />
                                </svg>
                                新增筆記
                            </h3>
                            <div class="form-group">
                                <label>筆記類型</label>
                                <div id="note-type-selector" style="display: flex; gap: 10px;">
                                    <button class="btn-pin active " data-type="morning">☀️ 起床</button>
                                    <button class="btn-pin" data-type="evening">🌙 睡前</button>
                                    <button class="btn-pin" data-type="note">📝 筆記</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>心情/分類標籤</label>
                                <div class="mood-tags" id="general-mood-tags"></div>
                            </div>
                            <div class="form-group">
                                <label>筆記內容</label>
                                <textarea id="general-mood-content" class="input-field"
                                    placeholder="記錄你的想法、夢境、待辦事項..."></textarea>
                            </div>
                            <div class="form-group">
                                <input type="file" id="general-mood-image" accept="image/*" style="display: none;">
                                <button class="btn" onclick="document.getElementById('general-mood-image').click()"
                                    style="background: #a5a5a5; padding: 10px 15px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                        stroke-linejoin="round" style="vertical-align: -5px;">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M15 8h.01" />
                                        <path d="M13 21h-7a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v7" />
                                        <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5" />
                                        <path d="M14 14l1 -1c.928 -.893 2.072 -.893 3 0l2 2" />
                                        <path d="M19 19m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" />
                                        <path d="M17 19l4 0" />
                                        <path d="M19 17l0 4" />
                                    </svg>
                                    附加圖片
                                </button>
                                <div id="general-mood-image-preview" style="margin-top: 15px;"></div>
                            </div>
                            <button class="btn" onclick="MoodTracker.saveGeneralEntry()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round" style="vertical-align: -6px;">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2" />
                                    <path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                                    <path d="M14 4v4h-8v-4" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="side-column ">
                        <div class="card-1 grainy-effect card particles">
                            <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M3 12h1" />
                                    <path d="M12 3v1" />
                                    <path d="M20 12h1" />
                                    <path d="M5.6 5.6l.7 .7" />
                                    <path d="M18.4 5.6l-.7 .7" />
                                    <path d="M8 12a4 4 0 1 1 8 0" />
                                    <path d="M3 16h18" />
                                    <path d="M3 20h18" />
                                </svg>昨日回顧</h3>
                            <div id="yesterday-review">
                                <p>暫無昨日記錄</p>
                            </div>
                        </div>
                        <div class="card-1 grainy-effect card particles">
                            <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path
                                        d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z" />
                                    <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116" />
                                    <path d="M6 9h-.01" />
                                </svg>標籤管理</h3>
                            <div class="form-group">
                                <label>新增自訂標籤</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" class="input-field-Details" id="custom-tag-input"
                                        placeholder="輸入新標籤">
                                    <button class="btn" onclick="MoodTracker.addCustomTag()"><svg
                                            xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                            stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M17 19h4" />
                                            <path
                                                d="M14 20h-8a3 3 0 0 1 0 -6h11a3 3 0 0 0 -3 3m7 -3v-8a2 2 0 0 0 -2 -2h-10a2 2 0 0 0 -2 2v8" />
                                            <path d="M19 17v4" />
                                        </svg></button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>我的自訂標籤</label>
                                <div id="custom-tags-list">
                                    <p>目前沒有自訂標籤。</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 5. 綜合統計 -->
            <div id="review-stats-section" class="content-section hidden">
                <div class="single-column-layout">
                    <div class="card-1 grainy-effect card particles">
                        <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path d="M11.5 21h-5.5a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
                                <path d="M16 3v4" />
                                <path d="M8 3v4" />
                                <path d="M4 11h16" />
                                <path
                                    d="M18 22l3.35 -3.284a2.143 2.143 0 0 0 .005 -3.071a2.242 2.242 0 0 0 -3.129 -.006l-.224 .22l-.223 -.22a2.242 2.242 0 0 0 -3.128 -.006a2.143 2.143 0 0 0 -.006 3.071l3.355 3.296z" />
                            </svg>筆記回顧</h3>
                        <div class="form-group"
                            style="display: flex; gap: 10px; margin-top: 20px; align-items: center;">
                            <label for="review-month">選擇月份：</label>
                            <input type="month" id="review-month" class="input-field-Details">
                        </div>
                        <div id="calendar-view"></div>
                        <div id="daily-summary-card" class="card-2 grainy-effect"
                            style="display: none; margin-top: 20px;">
                            <h3>
                                <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                    stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                    stroke-linejoin="round" style="vertical-align: -8px;">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                                    <path d="M12 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                                    <path d="M7 12l-2 0" />
                                    <path d="M12 7l0 -2" />
                                    <path d="M17 12l2 0" />
                                    <path d="M12 17l0 2" />
                                </svg>
                                <span id="summary-date-title"></span>當日綜合觀察
                            </h3>
                            <div id="daily-summary-content" style="padding-left: 10px; line-height: 2;">
                            </div>
                        </div>
                        <hr style="margin: 20px 0;">
                        <div id="review-content">
                            <p>請從上方月曆選擇日期查看記錄。</p>
                        </div>
                    </div>
                    <div class="card-2 grainy-effect card particles">
                        <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path d="M3 3v18h18" />
                                <path d="M20 18v3" />
                                <path d="M16 16v5" />
                                <path d="M12 13v8" />
                                <path d="M8 16v5" />
                                <path d="M3 11c6 0 5 -5 9 -5s3 5 9 5" />
                            </svg>綜合數據圖表</h3>
                        <canvas id="mood-chart"></canvas>
                    </div>

                </div>
            </div>
            <!-- 6. 圖像記憶 -->
            <div id="image-memory-section" class="content-section hidden">
                <div class="single-column-layout">
                    <div class="card-1 grainy-effect card particles">
                        <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M15 8h.01"></path>
                                <path
                                    d="M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z">
                                </path>
                                <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5"></path>
                                <path d="M14 14l1 -1c.928 -.893 2.072 -.893 3 0l2 2"></path>
                            </svg>圖像記憶</h3>
                        <p>這裡會顯示所有你在筆記中上傳過的圖片。</p>
                        <div id="image-gallery-container" style="margin-top: 20px;">
                        </div>
                    </div>
                </div>
            </div>
            <!-- 7. 資料設定 -->
            <div id="data-settings-section" class="content-section hidden">
                <div class="single-column-layout">
                    <div class="card-1 grainy-effect card particles" style="margin-top: 20px;">
                        <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path
                                    d="M7 7h10a2 2 0 0 1 2 2v1l1 1v3l-1 1v3a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-3l-1 -1v-3l1 -1v-1a2 2 0 0 1 2 -2z" />
                                <path d="M10 16h4" />
                                <circle cx="8.5" cy="11.5" r=".5" fill="currentColor" />
                                <circle cx="15.5" cy="11.5" r=".5" fill="currentColor" />
                                <path d="M9 7l-1 -4" />
                                <path d="M15 7l1 -4" />
                            </svg>AI 設定</h3>
                        <div class="form-group">
                            <label>選擇已儲存的 API Key</label>
                            <div style="display: flex; gap: 10px;">
                                <select id="api-key-select" class="input-field-Details"></select>
                                <button class="btn-delete" id="delete-api-key-btn"><svg
                                        xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path
                                            d="M10.17 6.159l2.316 -2.316a2.877 2.877 0 0 1 4.069 0l3.602 3.602a2.877 2.877 0 0 1 0 4.069l-2.33 2.33" />
                                        <path
                                            d="M14.931 14.948a2.863 2.863 0 0 1 -1.486 -.79l-.301 -.302l-6.558 6.558a2 2 0 0 1 -1.239 .578l-.175 .008h-1.172a1 1 0 0 1 -.993 -.883l-.007 -.117v-1.172a2 2 0 0 1 .467 -1.284l.119 -.13l.414 -.414h2v-2h2v-2l2.144 -2.144l-.301 -.301a2.863 2.863 0 0 1 -.794 -1.504" />
                                        <path d="M15 9h.01" />
                                        <path d="M3 3l18 18" />
                                    </svg></button>
                            </div>
                        </div>
                        <hr style="margin: 20px 0;">
                        <h5>新增 API Key</h5>
                        <div class="form-group">
                            <label>Key 的名稱</label>
                            <input type="text" class="input-field-Details" id="new-api-key-name"
                                placeholder="給你的 Key 一個好記的名字">
                        </div>
                        <div class="form-group">
                            <label>API Key</label>
                            <input type="password" class="input-field-Details" id="new-api-key-value"
                                placeholder="請輸入你的 AI API Key">
                        </div>
                        <button class="btn" id="add-api-key-btn"><svg xmlns="http://www.w3.org/2000/svg"
                                class="content-icon" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path
                                    d="M16.555 3.843l3.602 3.602a2.877 2.877 0 0 1 0 4.069l-2.643 2.643a2.877 2.877 0 0 1 -4.069 0l-.301 -.301l-6.558 6.558a2 2 0 0 1 -1.239 .578l-.175 .008h-1.172a1 1 0 0 1 -.993 -.883l-.007 -.117v-1.172a2 2 0 0 1 .467 -1.284l.119 -.13l.414 -.414h2v-2h2v-2l2.144 -2.144l-.301 -.301a2.877 2.877 0 0 1 0 -4.069l2.643 -2.643a2.877 2.877 0 0 1 4.069 0z" />
                                <path d="M15 9h.01" />
                            </svg></button>
                        <hr style="margin: 20px 0;">
                        <h5>其他 AI 設定</h5>
                        <div class="form-group">
                            <label>模型選擇</label>
                            <select id="ai-model-select" class="input-field-Details"
                                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
                                <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                                <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                <option value="mistral-large-2411">Mistral large 2411</option>
                                <option value="chatgpt-4o-latest">ChatGPT 4o</option>
                                <option value="gpt-4.1-2025-04-14">GPT 4.1</option>
                                <option value="grok-4-0709">Grok 4</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>記憶對話數</label>
                            <input type="number" id="context-length" class="input-field-Details" value="10" min="0"
                                max="50"
                                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
                        </div>
                        <div class="form-group">
                            <label>記憶幾日資料</label>
                            <input type="number" id="ai-data-days" class="input-field-Details" value="1" min="1"
                                max="30">
                        </div>
                        <div class="form-group">
                            <label>提示詞</label>
                            <small style="padding: 6px 0px; font-size: 0.8rem; margin-top: 5px; display: block;">
                                記憶資料捕捉的巨集為心情數據={{mood}}；習慣數據={{habits}}；時間安排={{schedule}}
                            </small>
                            <textarea class="input-field" id="ai-prompt" rows="5"></textarea>
                        </div>
                        <button class="btn" onclick="MoodTracker.saveSettings()">
                            <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2" />
                                <path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                                <path d="M14 4v4h-8v-4" />
                            </svg>
                        </button>
                    </div>
                    <div class="card-1 grainy-effect card particles" style="margin-top: 20px;">
                        <h3><svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path
                                    d="M3 4m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v2a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z" />
                                <path d="M12 20h-6a3 3 0 0 1 -3 -3v-2a3 3 0 0 1 3 -3h10.5" />
                                <path d="M18 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                                <path d="M18 14.5v1.5" />
                                <path d="M18 20v1.5" />
                                <path d="M21.032 16.25l-1.299 .75" />
                                <path d="M16.27 19l-1.3 .75" />
                                <path d="M14.97 16.25l1.3 .75" />
                                <path d="M19.733 19l1.3 .75" />
                                <path d="M7 8v.01" />
                                <path d="M7 16v.01" />
                            </svg>資料管理
                        </h3>

                        <div class="data-management-container">
                            <div class="data-management-grid">
                                <button class="data-management-btn export" onclick="DataManager.exportAllData()">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                                        <path
                                            d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                                        <path d="M12 11v6" />
                                        <path d="M9 14l3 -3l3 3" />
                                    </svg>
                                    <span>匯出資料</span>
                                </button>
                                <button class="data-management-btn import"
                                    onclick="document.getElementById('import-all-data-file').click()">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                                        <path
                                            d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                                        <path d="M12 11v6" />
                                        <path d="M15 14l-3 3l-3 -3" />
                                    </svg>
                                    <span>匯入資料</span>
                                </button>
                                <button class="data-management-btn warning" onclick="FloatingAIChat.clearChatHistory()">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M4 7h16" />
                                        <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                                        <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                                        <path d="M10.5 11l.5 5" />
                                        <path d="M13.5 11l-.5 5" />
                                        <path d="M12 21a3 3 0 0 1 -3 -3v-1h6v1a3 3 0 0 1 -3 3" />
                                    </svg>
                                    <span>清除AI聊天</span>
                                </button>
                                <button class="data-management-btn danger" onclick="DataManager.clearAllData()">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M4 7h16" />
                                        <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                                        <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                                        <path d="M10 12l4 4m0 -4l-4 4" />
                                    </svg>
                                    <span>清除所有資料</span>
                                </button>
                            </div>

                            <hr>

                            <div class="individual-exports">
                                <h4>各功能獨立匯出</h4>
                                <div
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                    <div>
                                        <h5>心情筆記</h5>
                                        <div class="data-buttons"><button class="data-btn export-btn"
                                                onclick="MoodTracker.exportData()">匯出心情筆記</button></div>
                                    </div>
                                    <div>
                                        <h5>習慣培養</h5>
                                        <div class="data-buttons"><button class="data-btn export-btn"
                                                onclick="HabitTracker.exportData()">匯出習慣資料</button></div>
                                    </div>
                                    <div>
                                        <h5>時間安排</h5>
                                        <div class="data-buttons"><button class="data-btn export-btn"
                                                onclick="TimeQuadrantTracker.exportData()">匯出時間安排</button></div>
                                    </div>
                                    <div>
                                        <h5>打卡記錄</h5>
                                        <div class="data-buttons"><button class="data-btn export-btn"
                                                onclick="AttendanceTracker.exportData()">匯出打卡記錄</button></div>
                                    </div>
                                    <div>
                                        <h5>AI 聊天</h5>
                                        <div class="data-buttons">
                                            <button class="data-btn export-btn"
                                                onclick="FloatingAIChat.exportData()">匯出聊天記錄</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input type="file" id="import-all-data-file" accept=".json" class="hidden"
                            onchange="DataManager.importAllData(event)">
                        <input type="file" id="import-mood-file" accept=".json" class="hidden"
                            onchange="MoodTracker.importData(event)">
                        <input type="file" id="import-habit-file" accept=".json" class="hidden"
                            onchange="HabitTracker.importData(event)">
                        <input type="file" id="import-task-file" accept=".json" class="hidden"
                            onchange="TimeQuadrantTracker.importData(event)">
                        <input type="file" id="import-attendance-file" accept=".json" class="hidden"
                            onchange="AttendanceTracker.importData(event)">
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>
    <div id="image-modal" class="hidden">
        <div class="modal-close-btn" onclick="ImageMemory.closeModal()">×</div>
        <div class="card-1 grainy-effect">
            <img id="modal-image" src="" style="max-width: 100%; max-height: 60vh; object-fit: contain;">
            <div id="modal-note-content" style="margin-top: 20px; border-radius: 8px; overflow-y: auto;"></div>
            <div id="modal-note-content" style="margin-top: 20px; border-radius: 8px; overflow-y: auto;">
            </div>
            <div class="card-2 modal-actions"
                style="margin-top: 15px; text-align: right; display: flex; justify-content: flex-end; gap: 10px;">
                <div class="view-mode-controls">
                    <button id="edit-modal-note-btn" class="btn-pin">✏️</button>
                    <button id="delete-modal-image-btn" class="btn-delete">🗑️</button>
                </div>
                <div class="edit-mode-controls hidden">
                    <button id="save-modal-note-btn" class="btn-save-unified">💾</button>
                    <button id="cancel-modal-note-btn" class="btn-cancel-unified">❌</button>
                </div>
            </div>
        </div>
    </div>
    <div id="global-search-container">
        <div id="global-search-window" class="hidden">
            <button class="modal-close-btn" onclick="FloatingSearch.closeWindow()">×</button>
            <div class="card-1 search-overlay-content grainy-effect card particles">
                <h3 id="search-window-title">全局搜尋</h3>
                <div class="search-input-area">
                    <input type="search" id="floating-search-input" placeholder="搜尋筆記、任務...">
                    <button id="floating-search-btn" class="btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="content-icon" viewBox="0 0 24 24"
                            stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"></path>
                            <path d="M21 21l-6 -6"></path>
                        </svg>
                    </button>
                </div>
                <div id="floating-search-results">
                    <p>請輸入關鍵字以開始搜尋。</p>
                </div>
            </div>
        </div>
    </div>
    <div id="ai-chat-window" class="hidden">
        <div class="chat-header">
            <h3>AI 心情助手</h3>
        </div>
        <div id="chat-context-menu" class="hidden">
            <button id="ctx-copy-btn" title="複製"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                    viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z" />
                    <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2" />
                </svg></button>
            <button id="ctx-quote-btn" title="引用"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                    viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M10 11h-4a1 1 0 0 1 -1 -1v-3a1 1 0 0 1 1 -1h3a1 1 0 0 1 1 1v6c0 2.667 -1.333 4.333 -4 5" />
                    <path d="M19 11h-4a1 1 0 0 1 -1 -1v-3a1 1 0 0 1 1 -1h3a1 1 0 0 1 1 1v6c0 2.667 -1.333 4.333 -4 5" />
                </svg></button>
            <button id="ctx-edit-btn" title="編輯"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                    viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" />
                    <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" />
                    <path d="M16 5l3 3" />
                </svg></button>
            <button id="ctx-delete-btn" title="刪除"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                    viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M4 7l16 0" />
                    <path d="M10 11l0 6" />
                    <path d="M14 11l0 6" />
                    <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                    <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                </svg></button>
        </div>
        <div class="chat-messages" id="ai-chat-messages">
        </div>
        <div class="chat-input-wrapper">
            <div id="file-preview-container"></div>
            <div class="chat-input">
                <button id="ai-chat-attach-btn" class="btn"><svg xmlns="http://www.w3.org/2000/svg" width="20"
                        height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path
                            d="M15 7l-6.5 6.5a1.5 1.5 0 0 0 3 3l6.5 -6.5a3 3 0 0 0 -6 -6l-6.5 6.5a4.5 4.5 0 0 0 9 9l6.5 -6.5" />
                    </svg></button>
                <input type="file" id="ai-chat-file-input" class="hidden">
                <textarea id="ai-chat-input" class="textarea" placeholder=""></textarea>
                <button id="ai-chat-send-btn" class="btn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                        viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path d="M10 14l11 -11" />
                        <path d="M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5" />
                    </svg></button>
            </div>
        </div>
    </div>
    <div class="bubble-container">
        <div id="global-search-bubble">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
                <path d="M21 21l-6 -6" />
            </svg>
        </div>
        <div id="ai-chat-bubble">
            <svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <path d="M4 21v-13a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-9l-4 4" />
                <path d="M9.5 9h.01" />
                <path d="M14.5 9h.01" />
                <path d="M9.5 13a3.5 3.5 0 0 0 5 0" />
            </svg>
            <div id="ai-chat-notification" class="hidden"></div>
        </div>
    </div>
    <div id="task-form-modal">
        <div class="card-2 grainy-effect card particles">
            <h3 id="form-title">新增任務</h3>
            <div class="form-body">
                <input type="hidden" id="task-id-input">
                <div class="form-group">
                    <label>時間</label>
                    <input type="text" class="input-field-Details" id="task-time-input">
                </div>
                <div class="form-group">
                    <label>內容</label>
                    <textarea id="task-content-input" class="input-field" placeholder="輸入任務內容..."></textarea>
                </div>
                <div class="form-group">
                    <label>時長 (分鐘)</label>
                    <input type="number" class="input-field-Details" id="task-duration-input" min="5" step="5"
                        value="30">
                    <div id="duration-adjust-buttons" style="margin-top: 8px; display: flex; gap: 8px;">
                        <button type="button" class="btn-duration-adjust" onclick="adjustDuration(15)">+15m</button>
                        <button type="button" class="btn-duration-adjust" onclick="adjustDuration(30)">+30m</button>
                        <button type="button" class="btn-duration-adjust" onclick="adjustDuration(60)">+1h</button>
                        <button type="button" class="btn-duration-adjust" onclick="adjustDuration(120)">+2h</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>選擇象限 (顏色)</label>
                    <div id="color-selector" class="color-selector" style="padding: 15px 0;">
                    </div>
                </div>
                <div class="form-group" id="recurring-task-section">
                    <label>
                        <input type="checkbox" id="recurring-task-checkbox"
                            onchange="document.getElementById('recurring-dates-container').style.display = this.checked ? 'block' : 'none'">
                        新增到多個日期 (重複性任務)
                    </label>
                    <div id="recurring-dates-container" style="display: none; margin-top: 10px;">
                        <label for="task-dates-input">選擇日期</label>
                        <input type="text" class="input-field-Details" id="task-dates-input" placeholder="點擊選擇一個或多個日期">
                    </div>
                </div>
            </div>
            <div class="form-footer" style="text-align: right; display:flex; gap: 10px; justify-content: flex-end;">
                <button class="btn-delete" id="delete-task-btn" onclick="TimeQuadrantTracker.deleteTaskFromModal()"
                    style="margin-right: auto; display: none;">🗑️</button>
                <button class="btn-save-unified" onclick="TimeQuadrantTracker.saveTask()">💾</button>
                <button class="btn-cancel-unified" onclick="TimeQuadrantTracker.closeTaskForm()">❌</button>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>

</html>